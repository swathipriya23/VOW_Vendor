<div class="container" style="margin-top: 20px;">
    <form [formGroup]="ppractiveclient">

        <div class="col-md-12">
            <div class="row">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-3">

                            <!-- <mat-form-field class="example-full-width">
                                <mat-label>bussines</mat-label>
                                <input type="text" placeholder="Pick one" aria-label="bussines" matInput
                                    formControlName="business_Search" [matAutocomplete]="auto" required>
                                <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayfnbussines">
                                    <mat-option *ngFor="let option of BsccSearch" [value]="option">
                                        {{option.bussines_name}}
                                    </mat-option>
                                </mat-autocomplete>
                            </mat-form-field> -->
                            <mat-form-field (click)="allocationform_search()" style="width: 220px;">
                                <mat-label>Business</mat-label>
                                <input #bssearchInput placeholder="Business" matInput formControlName="business_Search"
                                    [matAutocomplete]="bssearchAutoComplete" >
                                <mat-autocomplete #bssearchAutoComplete="matAutocomplete" [displayWith]="displaybspprsearch"
                                (opened)="allocationfromscroll()">
                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option *ngFor="let bscode of BsccSearch" [value]="bscode" >
                                            {{bscode.name}}
                                        </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </mat-form-field>

                        </div>
                        <div class="col-md-3">
                            <mat-form-field style="width: 100%;"  (click)="this.ppractiveclient.value.business_Search==null || this.ppractiveclient.value.business_Search==undefined || this.ppractiveclient.value.business_Search=='' ? '' : asset_dropdown()">
                                <mat-label>Asset class</mat-label>
                                <mat-chip-list #assetchip>
                                    <mat-chip *ngFor="let pro of chipSelectedprod" [selectable]=true [removable]=true
                                        (removed)="removedprod(pro)" [readonly]="this.ppractiveclient.value.business_Search==null || this.ppractiveclient.value.business_Search==undefined || this.ppractiveclient.value.business_Search==''"> {{pro.name}}
                                        <mat-icon matChipRemove>cancel</mat-icon>
                                    </mat-chip>
                                    <input #chipinput [formControl]="assestgrp" [matAutocomplete]="asset"
                                        [matChipInputFor]="assetchip"
                                        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                        [matChipInputAddOnBlur]=true
                                        [readonly]="this.ppractiveclient.value.business_Search==null || this.ppractiveclient.value.business_Search==undefined || this.ppractiveclient.value.business_Search==''">
                                </mat-chip-list>
                                <mat-autocomplete #asset="matAutocomplete" (optionSelected)="ppractiveSelected($event)">
                                    <mat-option *ngFor="let prod of assetList" [value]="prod"> {{prod.name}}
                                    </mat-option>
                                </mat-autocomplete>
                            </mat-form-field>


                            <!-- <mat-form-field (click)="asset_dropdown()">
                                <mat-label>Assest class</mat-label>
                                <input placeholder="Assest class" matInput [formControl]="assestgrp" #chipinput
                                    [matAutocomplete]="asset" required>
                                <mat-autocomplete #asset="matAutocomplete" [displayWith]="displayfnassest">
                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option *ngFor="let asset of assetList" [value]="asset">
                                            {{asset.asset_name}} </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </mat-form-field> -->
                        </div>
                        <div class="col-md-3">

                            <mat-form-field (click)="product_search()">
                                <mat-label>Product</mat-label>
                                <input placeholder="Product" matInput formControlName="productgrp" #product
                                    [matAutocomplete]="productsearch">
                                <mat-autocomplete #productsearch="matAutocomplete" [displayWith]="displayfnproductdisp"
                                    (opened)="autocompleteprodutsearch()">
                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option *ngFor="let productdata of productList" [value]="productdata">
                                            {{productdata.bsproduct_name}}
                                        </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </mat-form-field>
                        </div>

                        <div class="col-md-3">
                            <mat-form-field (click)="client_droupdown('CLIENT',assestgrp?.value?.id)">
                                <mat-label>Client</mat-label>
                                <input placeholder="Client" matInput formControlName="client_search" #client
                                    [matAutocomplete]="clientsearch">
                                <mat-autocomplete #clientsearch="matAutocomplete" [displayWith]="displayfnclient_search"
                                    (opened)="autocompleteclient_search('CLIENT',assestgrp?.value?.id)">
                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option *ngFor="let client of client_data" [value]="client">
                                            {{client.client_name}} </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </mat-form-field>
                        </div>
                        <div class="col-md-3">
                            <mat-form-field (click)="rm_droupdown('RM',assestgrp?.value?.id)">
                                <mat-label>RM</mat-label>
                                <input placeholder="RM" matInput formControlName="rm_search" #rm
                                    [matAutocomplete]="rmsearch">
                                <mat-autocomplete #rmsearch="matAutocomplete" [displayWith]="displayfnrm_search"
                                    (opened)="autocompleterm_search('RM',assestgrp?.value?.id)">
                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option *ngFor="let rm of rm_data" [value]="rm">
                                            {{rm.rm_name}} </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </mat-form-field>
                        </div>
                        <div class="col-md-3">
                            <mat-form-field class="example-full-width">
                                <mat-label>From Date</mat-label>
                                <input matInput [matDatepicker]="picker1" formControlName="client_fromdate"
                                    (dateChange)="clear_todate($event.value)" readonly required>
                                <mat-datepicker-toggle matSuffix [for]="picker1">
                                    <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
                                </mat-datepicker-toggle>
                                <mat-datepicker #picker1 startView="multi-year"></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="col-md-3">
                            <mat-form-field class="example-full-width">
                                <mat-label> To Date</mat-label>
                                <input matInput [matDatepicker]="picker2" formControlName="client_todate"
                                    [min]="maxDate"  readonly required>
                                <mat-datepicker-toggle matSuffix [for]="picker2">
                                    <mat-icon matDatepickerToggleIcon
                                        (click)="min_todate(ppractiveclient.value.client_fromdate)">keyboard_arrow_down
                                    </mat-icon>
                                </mat-datepicker-toggle>
                                <mat-datepicker #picker2 startView="multi-year"></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <!-- <div class="col-md-3">
                        <mat-form-field class="datepicker">
                            <input matInput [matDatepicker]="dp" placeholder="Month" [formControl]="date">
                            <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                            <mat-datepicker #dp [calendarHeaderComponent]="exampleHeader" startView="year"
                                (monthSelected)="chosenMonthHandler($event, dp)" panelClass="example-month-picker">
                            </mat-datepicker>
                        </mat-form-field>
                    </div> -->
                        <div class="col-md-2">
                            <div style="text-align: center;cursor: pointer;">
                                <button class="btn btn-outline-primary" style="border-radius: 40px;"
                                    (click)="pprsearch(assestgrp,ppractiveclient,monthsearch)">
                                    Search
                                </button>
                            </div>
                        </div>
                        <div class="col-md-1">
                            <div style="text-align: center;cursor: pointer;">
                                <button class="btn btn-outline-primary" style="border-radius: 40px;"
                                    (click)="pprsearch_clear(assestgrp,ppractiveclient)">
                                    Clear
                                </button>
                            </div>
                        </div>
                        <!-- <div class="col-md-3">
                            <button  class="btn btn-outline-primary" style="border-radius: 40px;" data-toggle="modal" data-target=".bd-fileupload-modal-lg">
                            <mat-icon>upload</mat-icon>Upload
                        </button> 
                        </div>-->
                    </div>

                </div>

            </div>
        </div>
    </form>
    <div>
        <!--  -->
        <h3 style="text-align: end; font-weight: bold;color: blue;margin-right: 20px;" [hidden]="supplierview">Amounts In Crores
            &nbsp;&nbsp;&nbsp;&nbsp;<button class="btn btn-outline-primary" matTooltip="Download"
                style="border-radius: 40px;" (click)="exceldownload()"><i class="fa fa-download"
                    aria-hidden="true"></i></button></h3>


        <!-- overflow: auto;
   
    max-height: 330px; -->
        <div class="row row-cols-md-1" style="margin-bottom: 2%;    overflow: auto;" [hidden]="supplierview">
            <!-- [hidden]="supplierview" -->
            <div class="col">
                <div class="card" id='activeclient-table'>
                    <div class="card-header">
                        <div>
                            <p style="text-align: start;">Active Client #</p>
                            <p style="float: right;"><button class="btn btn-outline-primary" matTooltip="Upload"
                                    style="border-radius: 40px;" data-toggle="modal" (click)="fileuploadopen('Active Client',1)"
                                    data-target=".bd-fileupload-modal-lg"><i class="fa fa-upload"
                                        aria-hidden="true"></i></button></p>

                        </div>
                        <!-- <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#multiCollapseExample2" aria-expanded="false" aria-controls="multiCollapseExample2">
                    </button> -->
                    </div>
                    <!-- <div class="collapse multi-collapse" id="multiCollapseExample2"> -->

                    <div class="card-body">

                        <div *ngIf="activeclient_summary?.length!=0" class="tableFixHead">
                            <table class="table table-bordered"  fixed-header>

                                <tbody>
                                    <tr >
                                        <th style="text-align: center;background-color: #00d7ff;">Name</th>
                                        <td *ngFor="let activeclient of activeclient_summary;" style="background-color: #00d7ff;" >
                                            {{activeclient.asset_name}}</td>
                                        <td style="background-color: #00d7ff;">Total</td>
                                    </tr>
                                    <tr>
                                        <th style="text-align: center;">BOP</th>
                                        <td *ngFor="let activeclient of activeclient_summary;">{{activeclient.bop}}</td>
                                        <td>{{boptotalamount}}</td>
                                    </tr>
                                    <tr>
                                        <th style="text-align: center;background-color: #EDF8FA;">New</th>
                                        <td *ngFor="let activeclient of activeclient_summary;" style="background-color: #EDF8FA;">
                                            {{activeclient.new_client}}</td>
                                            <td style="background-color: #EDF8FA;">{{new_clientamount}}</td>
                                    </tr>
                                    <tr>
                                        <th style="text-align: center;">Attrition</th>
                                        <td *ngFor="let activeclient of activeclient_summary;">
                                            {{activeclient.attrition}}</td>
                                            <td>{{attritionamount}}</td>
                                    </tr>
                                    <tr>
                                        <th style="text-align: center;background-color: #EDF8FA;">Closing</th>
                                        <td *ngFor="let activeclient of activeclient_summary;" style="background-color: #EDF8FA;">{{activeclient.closing}}
                                        </td>
                                        <td style="background-color: #EDF8FA;">{{closingamount}}</td>
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                        <div style="text-align: center;" id='activeclient-table'
                            *ngIf="activeclient_summary?.length==0">No Data Found</div>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card" id='typelist-table'>
                    <div class="card-header">
                        <div>
                            <p style="text-align: start;">Active Client Typelist</p>
                            <p style="float: right;color: #4b3ce5;">{{fromdate}} &nbsp; - &nbsp; {{todate}} </p>
                        </div>
                    </div>
                    <div class="card-body">

                        <div style="margin-top: 6%;" class="tableFixHead" *ngIf="!show_and_hide">
                            <table class="table table-bordered"  fixed-header>


                                <thead>
                                    <tr class="backcolor">
                                        <th >Name</th>
                                        <ng-container style="text-align: center;"
                                            *ngFor="let headername of header_name;let i=index">
                                            <th >{{headername}}</th>
                                        </ng-container>
                                    </tr>
                                </thead>


                                <tbody cdkDropList (cdkDropListDropped)="onDrop($event)">

                                    <tr cdkDrag *ngFor="let datas of ppr_clienttypelist;let i=index">
                                        <td  [ngStyle]="i%2==0?{'background-color':'white'} :{'background-color': '#EDF8FA'}">{{datas.name}}</td>
                                        <ng-container *ngFor="let com of datas.value;let j=index">
                                            <td [ngStyle]="i%2==0?{'background-color':'white'} :{'background-color': '#EDF8FA'}">
                                                <div *ngIf="datas?.value.length != 0 && datas?.name!='Growth OWN';"
                                                    style="text-align: right;">
                                                    {{datas.value[j]/10000000 | number:'1.1-2'}}
                                                </div>
                                                <div *ngIf="datas?.value.length != 0 && datas?.name=='Growth OWN';"
                                                    style="text-align: right;">
                                                    {{datas.value[j] | number:'1.1-2'}}
                                                </div>

                                            </td>
                                        </ng-container>


                                        <td *ngIf="datas?.value.length == 0;" [ngStyle]="i%2==0?{'background-color':'white'} :{'background-color': '#EDF8FA'}">0.00</td>

                                        <!-- <td>{{datas.value}}</td> -->
                                    </tr>
                                </tbody>
                            </table>
                            <!-- <div class="pagination">
                                    <pagination-controls (pageChange)="p = $event"></pagination-controls>
                                  </div> -->
                            <!-- <table class="table table-bordered" fixed-header id="commonstyle">
                                <thead>
                                    <th>Name</th>
                                    <th>{{ header_name }}</th>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let typelist of ppr_clienttypelist;let i=index">
                                        <td>{{typelist.name}}</td>
                                        <td>{{typelist.value/10000000 | number : '1.2-2'}} </td>
                                    </tr>
                                </tbody>
                            </table> -->

                        </div>
                        <div style="text-align: center;" *ngIf="show_and_hide">No Data Found</div>

                    </div>
                    <!-- </div> -->
                </div>
            </div>
            <div class="col">
                <div class="card" id="profitability">
                    <div class="card-header">
                        <div>
                            <p style="text-align: start;"> Profitability Report Details</p>
                            <p style="float: right;"><button class="btn btn-outline-primary" matTooltip="Upload"
                                style="border-radius: 40px;" data-toggle="modal" (click)="fileuploadopen('Income',3)"
                                data-target=".bd-fileupload-modal-lg"><i class="fa fa-upload"
                                    aria-hidden="true"></i></button></p>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="tableFixHead" >
                            <table class="table table-bordered"  fixed-header>
                                <thead>
                                    <tr class="backcolor">
                                        <th>Name</th>
                                        <th *ngFor="let head_val of income_exp_header">{{head_val}}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let datas of income_expense;let i=index">
                                        <td [ngStyle]="{'padding':'5px','padding-left':datas.Padding_left}">
                                            <a  [ngStyle]="{'color': datas.color }" (click)="datas.Padding_left=='130px' || (datas.Padding_left=='10px' && datas.color == 'black')  ? '' :treeincome_expense(assest,income_expense,datas,i)">
                                                {{datas.name}}
                                            </a>                                           
                                        </td>
                                        <td class="tablechange" *ngFor="let head_val of income_exp_header">
                                        <ng-container *ngFor="let dats of datas.asset_name;let ie=index">

                                                <ng-container *ngIf="head_val==dats">
                                                {{datas.amount[ie]/10000000 | number:'1.1-2' }}
                                                </ng-container>
                                            </ng-container>
                                        </td> 
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div *ngIf="income_expense?.length==0">
                            <p>No Data Found...</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="modal fade bd-fileupload-modal-lg" data-toggle="modal" data-backdrop="static" data-keyboard="false"
        tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabels">
        <div class="modal-dialog modal-lg" style="padding-top: 7%;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">{{filed_name}} &nbsp; Upload</h2>
                    <button type="button" class="close" (click)="clear_filedetails()" #closepop data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">



                    <div class="card">
                        <div class="card-body" style="margin-top: 2%;margin-bottom: 2%;">

                            <div class="input-group mb-3">

                                <div class="custom-file">
                                    <input type="file" [formControl]='clientinput' id="uploadFile" class="choose"
                                    (change)="upload_file($event)" accept=".xlsx">


                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="modal-footer">
                    <button class="btn btn-outline-primary" type="button" style="float: right;" (click)="upload(numberoffiled)" >
                        Upload
                    </button>
                    <button class="btn btn-outline-secondary" type="button" data-dismiss="modal" style="float: right ;"
                        (click)="clear_filedetails()">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade bd-otheroperatingexpupload-modal-lg" data-toggle="modal" data-backdrop="static" data-keyboard="false"
    tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabels">
    <div class="modal-dialog modal-lg" style="padding-top: 7%;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Other Operating Expense &nbsp;&nbsp; File Upload</h2>
                <button type="button" class="close" (click)="clear_filedetails()" #closepopexp data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">



                <div class="card">
                    <div class="card-body" style="margin-top: 2%;margin-bottom: 2%;">

                        <div class="input-group mb-3">
                            <form [formGroup]="otheroperating">
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Enter The Page Number</mat-label>
                                                <input matInput placeholder="Page Number" type="number" autocomplete="off" formControlName="pagenum" min="1" oninput="validity.valid||(value='');" required>
                                            </mat-form-field>  
                                        </div>
                                        <div class="col-md-6">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Enter The Page Size</mat-label>
                                                <input matInput placeholder="Page Size" type="number" autocomplete="off" formControlName="pagesize" min="1" oninput="validity.valid||(value='');" required>
                                            </mat-form-field>  
                                        </div>
                                        <div class="col-md-6">
                                            <mat-form-field appearance="outline" class="example-full-width">
                                                <mat-label>From Date</mat-label>
                                                <input matInput [matDatepicker]="transactionfromdatepicker" formControlName="transactionstartdate"
                                                   (dateChange)="transactiontodate($event.value)" readonly required>
                                                <mat-datepicker-toggle matSuffix [for]="transactionfromdatepicker">
                                                   
                                                </mat-datepicker-toggle>
                                                <mat-datepicker #transactionfromdatepicker startView="multi-year"></mat-datepicker>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-6">
                                            <mat-form-field appearance="outline" class="example-full-width" >
                                                <mat-label> To Date</mat-label>
                                                <input matInput [matDatepicker]="transactiontodatepicker" formControlName="transactiontodate"
                                                    [min]="transation_minDate"  readonly required>
                                                <mat-datepicker-toggle matSuffix [for]="transactiontodatepicker" [disabled]="otheroperating.value.transactionstartdate==''|| otheroperating.value.transactionstartdate == null || otheroperating.value.transactionstartdate== undefined">
                                                    <mat-icon matDatepickerToggleIcon
                                        (click)="trancationmin_todate(otheroperating.value.transactionstartdate)" >calendar_today
                                    </mat-icon>
                                                </mat-datepicker-toggle>
                                                <mat-datepicker #transactiontodatepicker startView="multi-year"></mat-datepicker>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                </div>
                            </form>
                           
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-primary" type="button" style="float: right;" (click)="otheroperatingupload(otheroperating)" >
                    Upload
                </button>
                <button class="btn btn-outline-secondary" type="button" data-dismiss="modal" style="float: right ;"
                    (click)="clear_filedetails()">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>

</div>